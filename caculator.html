<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculator App</title>
  <style>
    :root{
      --bg1:#ffd6e8;
      --bg2:#ff6fa3;
      --card:#fff;
      --accent:#ff4d94;
      --muted:#777;
      --btn-shadow: 0 6px 18px rgba(0,0,0,0.08);
      --radius:16px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      display:grid;
      place-items:center;
      padding:24px;
      background:linear-gradient(180deg,var(--bg1),#ffd0e0 30%, #ffd0f0 60%);
    }
    .container{
      width:360px;
      max-width:100%;
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.12);
      background:linear-gradient(180deg, rgba(255,115,175,0.12), rgba(255,115,175,0.04));
      border:1px solid rgba(255,255,255,0.6);
    }
    header{
      padding:28px 24px;
      background:linear-gradient(90deg,#ff9ac8,#ff6fa3);
      color:white;
      display:flex;
      gap:12px;
      align-items:center;
    }
    .icon{
      width:56px;height:56px;
      background:rgba(255,255,255,0.18);
      display:grid;place-items:center;border-radius:12px;
      box-shadow:var(--btn-shadow);
      flex:0 0 56px;
    }
    .icon svg{width:34px;height:34px;opacity:0.95}
    header h1{font-size:18px;margin:0}
    header p{margin:0;font-size:12px;opacity:0.95}

    .card{
      background:var(--card);
      padding:18px;
    }
    .display{
      height:86px;
      background:linear-gradient(180deg,#fff,#fbfbfb);
      border-radius:12px;
      padding:12px 14px;
      display:flex;flex-direction:column;justify-content:center;align-items:flex-end;
      box-shadow:inset 0 -6px 18px rgba(0,0,0,0.02);
      font-weight:600;color:#111;
    }
    .sub{font-size:14px;color:var(--muted);opacity:0.9}
    .main{font-size:28px;line-height:1;margin-top:6px}

    .keys{margin-top:14px;display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
    .btn{
      height:56px;border-radius:12px;border:0;font-size:18px;font-weight:600;cursor:pointer;
      box-shadow:var(--btn-shadow);background:#fff;transition:transform .08s ease, box-shadow .08s ease;
    }
    .btn:active{transform:translateY(2px)}
    .btn--muted{background:#f6f6f6;color:#333}
    .btn--accent{background:linear-gradient(180deg,var(--accent),#ff6fa3);color:#fff}
    .btn--big{grid-column:span 2}

    footer{padding:10px 18px 18px;font-size:13px;color:var(--muted);text-align:center}

    @media (max-width:400px){
      .main{font-size:24px}
      .display{height:76px}
    }
  </style>
</head>
<body>
  <div class="container" role="application" aria-label="Calculator">
    <header>
      <div class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="2" width="16" height="20" rx="3" fill="white" opacity="0.12"/><path d="M8 6h8" stroke="white" stroke-width="1.4" stroke-linecap="round"/><circle cx="8" cy="12" r="1.3" fill="white"/><circle cx="12" cy="12" r="1.3" fill="white"/><circle cx="16" cy="12" r="1.3" fill="white"/><rect x="7" y="15" width="10" height="2" rx="0.8" fill="white"/></svg>
      </div>
      <div>
        <h1>Calculator App</h1>
        <p>Simple calculator built with HTML, CSS, and JavaScript</p>
      </div>
    </header>

    <div class="card">
      <div class="display" id="display" aria-live="polite">
        <div class="sub" id="expression">0</div>
        <div class="main" id="result">0</div>
      </div>

      <div class="keys" role="group" aria-label="calculator keys">
        <button class="btn btn--muted" data-key="clear" aria-label="Clear">C</button>
        <button class="btn btn--muted" data-key="back" aria-label="Backspace">⌫</button>
        <button class="btn btn--muted" data-key="percent" aria-label="Percent">%</button>
        <button class="btn btn--accent" data-key="/" aria-label="Divide">÷</button>

        <button class="btn" data-key="7">7</button>
        <button class="btn" data-key="8">8</button>
        <button class="btn" data-key="9">9</button>
        <button class="btn btn--accent" data-key="*" aria-label="Multiply">×</button>

        <button class="btn" data-key="4">4</button>
        <button class="btn" data-key="5">5</button>
        <button class="btn" data-key="6">6</button>
        <button class="btn btn--accent" data-key="-" aria-label="Subtract">−</button>

        <button class="btn" data-key="1">1</button>
        <button class="btn" data-key="2">2</button>
        <button class="btn" data-key="3">3</button>
        <button class="btn btn--accent" data-key="+" aria-label="Add">+</button>

        <button class="btn btn--muted btn--big" data-key="0">0</button>
        <button class="btn" data-key=".">.</button>
        <button class="btn btn--accent" data-key="equals" aria-label="Equals">=</button>
      </div>
    </div>

    <footer>Keyboard: numbers, + - * / . Enter =, Backspace, Esc to clear</footer>
  </div>

  <script>
    (function(){
      const expressionEl = document.getElementById('expression');
      const resultEl = document.getElementById('result');
      const keys = document.querySelectorAll('[data-key]');

      let expr = '';
      let lastIsOp = false;

      function updateView(){
        expressionEl.textContent = expr || '0';
        resultEl.textContent = computePreview() || '0';
      }

      function pushToken(token){
        if(token === 'clear') return clearAll();
        if(token === 'back') return backspace();
        if(token === 'equals') return evaluateExpr();
        if(token === 'percent') return handlePercent();

        if(['+','-','*','/'].includes(token)){
          if(!expr) return; 
          if(lastIsOp){
            expr = expr.slice(0, -1) + token;
          } else {
            expr += token;
          }
          lastIsOp = true;
        } else if(token === '.'){
          const parts = expr.split(/[-+*/]/);
          const last = parts[parts.length-1] || '';
          if(last.includes('.')) return;
          if(last === '') expr += '0.'; else expr += '.';
          lastIsOp = false;
        } else {
          expr += token;
          lastIsOp = false;
        }
        updateView();
      }

      function clearAll(){ expr=''; lastIsOp=false; updateView(); }
      function backspace(){ if(!expr) return; expr = expr.slice(0,-1); lastIsOp = /[+\-*/]$/.test(expr); updateView(); }

      function handlePercent(){
        const parts = expr.split(/([+\-*/])/);
        if(parts.length===0) return;
        for(let i=parts.length-1;i>=0;i--){
          if(!['+','-','*','/'].includes(parts[i])){
            const num = parts[i];
            if(num==='') return;
            const val = parseFloat(num);
            if(isNaN(val)) return;
            parts[i] = String(val/100);
            expr = parts.join('');
            updateView();
            return;
          }
        }
      }

      function computePreview(){
        if(!expr) return '';
        try{
          const safeExpr = expr.replace(/×/g,'*').replace(/÷/g,'/');
          if(/[+\-*/]$/.test(safeExpr)) return '';
          if(/[^0-9+\-*/().]/.test(safeExpr)) return '';
          const val = Function('return (' + safeExpr + ')')();
          if(!isFinite(val)) return 'Error';
          return +parseFloat(val.toFixed(10));
        }catch(e){return 'Error'}
      }

      function evaluateExpr(){
        const res = computePreview();
        if(res === '' || res === 'Error') return;
        expr = String(res);
        lastIsOp = false;
        updateView();
      }

      keys.forEach(k=>k.addEventListener('click', ()=> pushToken(k.dataset.key)));

      window.addEventListener('keydown', (e)=>{
        const k = e.key;
        if((/^[0-9]$/).test(k)) { pushToken(k); e.preventDefault(); }
        else if(k === '.') { pushToken('.'); e.preventDefault(); }
        else if(k === '+'||k === '-'||k === '*'||k === '/') { pushToken(k); e.preventDefault(); }
        else if(k === 'Enter' || k === '='){ pushToken('equals'); e.preventDefault(); }
        else if(k === 'Backspace'){ pushToken('back'); e.preventDefault(); }
        else if(k === 'Escape'){ pushToken('clear'); e.preventDefault(); }
        else if(k === '%'){ pushToken('percent'); e.preventDefault(); }
      });

      updateView();
    })();
  </script>
</body>
</html>
